function buildReducerMap(e){return(e||[]).reduce(function(e,t){return e[t.name]=t.reducer,e},{})}function getStore(){return store}function setStore(e){store=e}function makeAction(e,t,r){var n={type:e};return t.forEach(function(e,o){n[t[o]]=r[o]}),n}function makeActionCreator(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=makeAction(e,r,n);getStore().dispatch(i)}}function makeAsyncAction(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=makeAction(null,r,n),a=function(t,r){return e(i,t,r)};return getStore().dispatch(a)}}function peek(e,t){for(var r=t.split("."),n=r.pop(),o=void 0;o=r.shift();){if(void 0===e[o])return;e=e[o]}return e[n]}function lookup(e,t,r){if("string"==typeof t)return r&&(t=r+"."+t),peek(e,t);if("function"==typeof t){r&&(e=e[r]);try{return t(e)}catch(e){return}}}function isFunction(e){return e instanceof Function}function isObject(e){return null!==e&&"object"===(void 0===e?"undefined":_typeof(e))}function externalizeSelectors(e,t){var r=t.name,n=t.options.propsNamespace;void 0!==n&&"string"!=typeof n&&(console.warn("redux-model-utils: propsNamespace must be a string"),n=null);var o=function(t){var o=Object.keys(e).reduce(function(n,o){return n[o]=lookup(t,e[o],r),n},{});return n?defineProperty({},n,o):o};return n&&Object.defineProperty(o,"_rmu_namespace",{enumerable:!1,value:n}),o}function reactify(e){e.reactSelectors=externalizeSelectors(e.selectors||{},e),e.propsMaps=Object.keys(e.propsMaps||{}).reduce(function(t,r){return t[r]=externalizeSelectors(e.propsMaps[r],e),t},{})}function mergeReactSelectors(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){var r={};return(t||[]).forEach(function(t){t._rmu&&(t=t.reactSelectors);var n=t(e),o=t._rmu_namespace;o?(r[o]=r[o]||{},Object.assign(r[o],n[o])):Object.assign(r,n)}),r}}function buildAccessors(e){e.data={},Object.keys(e.selectors).forEach(function(t){Object.defineProperty(e.data,t,{get:function(){return lookup(getStore().getState(),e.selectors[t],e.name)}})}),Object.defineProperty(e,"allData",{get:function(){var t=getStore().getState(),r=t[e.name];return"object"===(void 0===r?"undefined":_typeof(r))?r:t}})}function isAction(e){return isObject(e)&&(isFunction(e.reducer)||isFunction(e.async)||isFunction(e.thunk))}function mapActions(e,t,r){var n=r.actionTree,o=r.privateTree,i=r.allReducers,a=r.model;Object.keys(e).forEach(function(c){var u=e[c],s=u.params,l=u.async,f=u.thunk,p=u.reducer,d=u.actionType,v=void 0===d?t+"/"+c:d,y=u.private,m=objectWithoutProperties(u,["params","async","thunk","reducer","actionType","private"]),b=void 0,h=void 0;if(isAction(u)){y?(b=o,r.anyPrivate=!0):b=n,"string"==typeof s?s=[s]:s||(s=[]);var A=l||f;A?h=makeAsyncAction.apply(void 0,[A].concat(toConsumableArray(s))):(h=makeActionCreator.apply(void 0,[v].concat(toConsumableArray(s))),i[v]&&console.warn("redux-model-utils: multiple reducers are installed on model["+a.name+'] for action type = "'+v+'"'),i[v]=p),b[c]=h}Object.keys(m).length>0&&(r.actionTree=n[c]=h||{},r.privateTree=o[c]=h||{},mapActions(u,c,r),r.actionTree=n,r.privateTree=o)})}function parseActionMap(e){var t={model:e,actionTree:{},privateTree:{},allReducers:{},anyPrivate:!1};mapActions(e.actionMap,e.name,t),e.actions=t.actionTree,e._rmu.privateActions=t.privateTree,e.reducer=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.initialState,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.allReducers[n.type];return o&&(r=o(r,n)),r},t.anyPrivate&&(e.severPrivateActions=function(){var t=e._rmu.privateActions;return e._rmu.privateActions=e.severPrivateActions=null,t}),e.actionMap=null}function subscribe(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=void 0,o=this&&this._rmu?this.name:"",i=r.equals||function(e,t){return e===t},a=function(){return lookup(getStore().getState(),e,o)},c=function(){var e=a();if(!i(n,e)){var r=n;n=e,t(e,r)}};return r.noInit||t(n=a()),getStore().subscribe(c)}function validateAndCleanup(e){if(-1!==allModelNames.indexOf(e.name))throw new Error("redux-model-utils: Two models have the same name ("+e.name+")");allModelNames.push(e.name),e.reducer&&(console.log("MASTER REDUCER:",e),console.trace('redux-model-utils: You cannot provide a master "reducer" method; it is created for you.')),e.actionMap||e.initialState||console.error("redux-model-utils: You must provide actionMap and initialState objects."),e.options||(e.options={}),e.selectors||(e.selectors={})}function modelBuilder(e){return validateAndCleanup(e),Object.defineProperty(e,"_rmu",{enumerable:!1,value:{}}),e.subscribe=subscribe,parseActionMap(e),reactify(e),buildAccessors(e),e}var store=void 0,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},asyncGenerator=function(){function e(e){this.value=e}function t(t){function r(e,t){return new Promise(function(r,o){var c={key:e,arg:t,resolve:r,reject:o,next:null};a?a=a.next=c:(i=a=c,n(e,t))})}function n(r,i){try{var a=t[r](i),c=a.value;c instanceof e?Promise.resolve(c.value).then(function(e){n("next",e)},function(e){n("throw",e)}):o(a.done?"return":"normal",a.value)}catch(e){o("throw",e)}}function o(e,t){switch(e){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}(i=i.next)?n(i.key,i.arg):a=null}var i,a;this._invoke=r,"function"!=typeof t.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)},{wrap:function(e){return function(){return new t(e.apply(this,arguments))}},await:function(t){return new e(t)}}}(),defineProperty=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},objectWithoutProperties=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r},toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},allModelNames=[];export{mergeReactSelectors,modelBuilder,makeAction,makeActionCreator,makeAsyncAction,buildReducerMap,getStore,setStore};